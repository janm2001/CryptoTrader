<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:CryptoTrader.App.ViewModels"
             x:Class="CryptoTrader.App.Views.AdminView"
             x:DataType="vm:AdminViewModel">

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- System Stats -->
        <Border Grid.Row="0" Background="#2D2D2D" CornerRadius="10" Padding="20" Margin="20,20,20,10">
            <Grid ColumnDefinitions="*,*,*,*" RowDefinitions="Auto,Auto">
                <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding L[TotalUsers]}"
                           Foreground="#888" HorizontalAlignment="Center"/>
                <TextBlock Grid.Row="1" Grid.Column="0" Text="{Binding TotalUsers}"
                           FontSize="24" FontWeight="Bold" Foreground="#5B8DEE" HorizontalAlignment="Center"/>

                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding L[TotalTransactions]}"
                           Foreground="#888" HorizontalAlignment="Center"/>
                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding TotalTransactions}"
                           FontSize="24" FontWeight="Bold" Foreground="#4ECB71" HorizontalAlignment="Center"/>

                <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding L[MyHoldings]}"
                           Foreground="#888" HorizontalAlignment="Center"/>
                <TextBlock Grid.Row="1" Grid.Column="2" Text="{Binding TotalHoldings}"
                           FontSize="24" FontWeight="Bold" Foreground="#F0B90B" HorizontalAlignment="Center"/>

                <TextBlock Grid.Row="0" Grid.Column="3" Text="{Binding L[CryptoMarket]}"
                           Foreground="#888" HorizontalAlignment="Center"/>
                <TextBlock Grid.Row="1" Grid.Column="3" Text="{Binding TrackedCryptos}"
                           FontSize="24" FontWeight="Bold" Foreground="#E0E0E0" HorizontalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Users List -->
        <Border Grid.Row="1" Background="#2D2D2D" CornerRadius="10" Margin="20,10">
            <Grid RowDefinitions="Auto,*">
                <TextBlock Grid.Row="0" Text="{Binding L[UserManagement]}"
                           FontWeight="Bold" FontSize="16" Foreground="#E0E0E0"
                           Margin="15,15,15,10"/>

                <DataGrid Grid.Row="1" ItemsSource="{Binding Users}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          GridLinesVisibility="Horizontal"
                          Background="Transparent"
                          Name="UsersGrid">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                        <DataGridTextColumn Header="{Binding $parent[UserControl].((vm:AdminViewModel)DataContext).L[Username]}" Binding="{Binding Username}" Width="*"/>
                        <DataGridTextColumn Header="{Binding $parent[UserControl].((vm:AdminViewModel)DataContext).L[Email]}" Binding="{Binding Email}" Width="*"/>
                        <DataGridTextColumn Header="{Binding $parent[UserControl].((vm:AdminViewModel)DataContext).L[UserRole]}" Binding="{Binding Role}" Width="80"/>
                        <DataGridCheckBoxColumn Header="{Binding $parent[UserControl].((vm:AdminViewModel)DataContext).L[Active]}" Binding="{Binding IsActive}" Width="70"/>
                        <DataGridTextColumn Header="{Binding $parent[UserControl].((vm:AdminViewModel)DataContext).L[Date]}" Binding="{Binding CreatedAt, StringFormat={}{0:d}}" Width="120"/>
                        <DataGridTemplateColumn Header="Actions" Width="180">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="5" HorizontalAlignment="Center">
                                        <Button Content="{Binding $parent[UserControl].((vm:AdminViewModel)DataContext).L[ChangeRole]}"
                                                Background="#5B8DEE"
                                                Foreground="White"
                                                Padding="8,4"
                                                FontSize="11"
                                                CornerRadius="3"
                                                Tag="{Binding}"
                                                Click="OnToggleAdminClick"/>
                                        <Button Content="{Binding $parent[UserControl].((vm:AdminViewModel)DataContext).L[Delete]}"
                                                Background="#FF6B6B"
                                                Foreground="White"
                                                Padding="8,4"
                                                FontSize="11"
                                                CornerRadius="3"
                                                Tag="{Binding}"
                                                Click="OnDeleteUserClick"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>

        <!-- Bottom Actions -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center"
                    Spacing="15" Margin="20">
            <Button Content="{Binding L[RefreshPrices]}"
                    Background="#F0B90B"
                    Foreground="Black"
                    Padding="25,12"
                    CornerRadius="5"
                    Click="OnRefreshPricesClick"
                    IsEnabled="{Binding !IsLoading}"/>

            <Button Content="{Binding L[Refresh]}"
                    Background="#5B8DEE"
                    Foreground="White"
                    Padding="25,12"
                    CornerRadius="5"
                    Click="OnRefreshClick"
                    IsEnabled="{Binding !IsLoading}"/>

            <!-- Status Message -->
            <TextBlock Text="{Binding StatusMessage}"
                       IsVisible="{Binding HasStatusMessage}"
                       VerticalAlignment="Center"
                       Margin="15,0,0,0">
                <TextBlock.Styles>
                    <Style Selector="TextBlock">
                        <Setter Property="Foreground" Value="#FF6B6B"/>
                    </Style>
                </TextBlock.Styles>
            </TextBlock>

            <!-- Loading -->
            <TextBlock Text="{Binding L[Loading]}" FontSize="14" Foreground="#5B8DEE"
                       IsVisible="{Binding IsLoading}" VerticalAlignment="Center"/>
        </StackPanel>
    </Grid>
</UserControl>
